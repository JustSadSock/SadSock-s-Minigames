<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Arcade — Pastel Pixel</title>
  <!-- необязательно: пиксельный шрифт; оффлайн будет fallback -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    :root{
      /* ===== ЯРКАЯ 8-бит палитра (NES/Famicom vibe, без серо-синих) ===== */
      --bg0:#f7ecd8;      /* светлый фон всей страницы */
      --bg0-dot1:#ffd1dc; /* пастельные точки на заднике */
      --bg0-dot2:#ffe3c6;
      --ink:#241b12;      /* тёплый тёмный текст */
      --dim:#5a4a3b;      /* подписи */

      /* Корпус автомата — «фамиком-красный» и крем */
      --cabinet-red-1:#b92323;
      --cabinet-red-2:#861a1a;
      --cabinet-cream:#f2d9ab;
      --cabinet-brown:#7a4520;

      /* Внутренний экран */
      --bg2:#11151b;      /* глубокий тёмный для «стекла» */
      --scan:0.045;       /* чуть мягче сканлайны */
      --crt-curve:18px;   /* слегка меньше радиус */

      /* Акценты */
      --gold:#ffcf5b;
      --gold-deep:#e0a836;
      --mint:#8fe4c0;
      --peach:#ffc88c;
      --rose:#ff9eb8;
      --sky:#4aa3ff;      /* небольшой акцент в пиксель-рамках */
      --tile-blue:#68a0ff;
      --tile-red:#ff6b6b;
      --tile-green:#67e6a3;
      --tile-yellow:#ffd86a;

      /* размеры */
      --tile:146px;       /* крупнее иконки — меньше пустоты */
      --px:1px;
      --gap: clamp(18px, 4.2vmin, 34px);
    }
    *{box-sizing:border-box}
    html,body{
      height:100%; margin:0; color:var(--ink);
      /* светлый теплый фон со «шахматками» */
      background:
        radial-gradient(var(--bg0-dot1) 1px, transparent 1px) 0 0/8px 8px,
        radial-gradient(var(--bg0-dot2) 1px, transparent 1px) 4px 4px/8px 8px,
        linear-gradient(#fffaf0,#f7ecd8 50%, #f3e4c6 100%);
      font-family:'Press Start 2P', ui-monospace, Consolas, monospace;
      letter-spacing:.35px;
      overflow:hidden;
    }

    /* пиксельная рамка вокруг всей сцены (как декоративная панель) */
    body::before{
      content:""; position:fixed; inset:10px; pointer-events:none; z-index:0;
      border-radius:12px;
      background:
        linear-gradient(90deg, #0000 14px, #0002 14px 16px, #0000 16px) 0 0/100% 8px,
        linear-gradient(180deg, #0000 14px, #0002 14px 16px, #0000 16px) 0 0/8px 100%;
    }

    /* центрируем «кабинет», растягиваем почти на весь экран */
    .cabinet{
      position:fixed; inset:0; display:grid; place-items:center;
      padding:min(1.8vw,14px);
      z-index:1;
    }

    /* внешний корпус — тоньше, чтобы экран был больше */
    .shell{
      width:min(1840px, 99vw);
      height:min(1040px, 98.5svh);
      display:grid; place-items:center;
      border-radius:18px;
      /* Famicom-красный корпус с пиксельной окантовкой */
      background:
        linear-gradient(180deg, var(--cabinet-red-1), var(--cabinet-red-2));
      box-shadow:
        0 24px 56px rgba(0,0,0,.45),
        inset 0 0 0 2px #4a0f0f,
        inset 0 0 0 8px #761717;
      padding:8px;   /* ещё больше экран */
      position:relative;
    }

    /* Пиксельная кремовая окантовка по периметру корпуса */
    .shell::before{
      content:""; position:absolute; inset:6px;
      border-radius:12px;
      background:
        repeating-linear-gradient(90deg, var(--cabinet-cream) 0 6px, #f6e6c7 6px 12px);
      box-shadow: inset 0 0 0 2px var(--cabinet-brown);
      z-index:0;
    }

    /* внутренний обод (bezel) — кремовый, с «пиксель-ступеньками» */
    .bezel{
      width:100%; height:100%;
      border-radius:14px;
      background:
        linear-gradient(180deg, #f5ddaf, #f3d39b 60%, #efc77c);
      box-shadow:
        inset 0 0 0 2px var(--cabinet-brown),
        inset 0 0 0 8px #eabf7a,
        inset 0 30px 80px rgba(0,0,0,.20),
        inset 0 -20px 60px rgba(0,0,0,.25);
      padding:8px;  /* минимальная кромка */
      display:grid; grid-template-rows: auto 1fr; gap:8px; place-items:center;
      position:relative;
      z-index:1;
    }

    /* Маркиза (верхняя цветная полоса с 8-бит рамкой) */
    .marquee8{
      width:99.2%; height:54px; border-radius:8px;
      background:
        repeating-linear-gradient(90deg, #ffb3c1 0 10px, #ffc88c 10px 20px, #a7f0d0 20px 30px, #ffe36e 30px 40px);
      box-shadow:
        inset 0 0 0 2px #2b1a0a,
        inset 0 0 0 4px #fff6,
        0 4px 0 #0003;
      display:grid; place-items:center;
      position:relative;
    }
    .marquee8 span{
      font-size:12px; color:#2b1a0a; text-shadow:0 1px 0 #ffe, 0 2px 0 #0002;
      letter-spacing:1px;
    }

    /* сам «экран» — максимально крупный, тёплые блики и 8-битная рамка */
    .screen{
      position:relative;
      width:100%; height:100%;
      border-radius:var(--crt-curve);
      background:
        radial-gradient(140% 110% at 50% 18%, rgba(255,255,255,.045), transparent 55%),
        radial-gradient(120% 120% at 50% 118%, rgba(0,0,0,.22), transparent 50%),
        linear-gradient(180deg, #0c1118, var(--bg2));
      box-shadow:
        inset 0 0 0 2px #020409,
        inset 0 0 0 6px #0a0f19,
        inset 0 0 60px rgba(0,0,0,.45),
        inset 0 0 220px rgba(0,0,0,.24);
      overflow:hidden;
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: var(--gap);
      padding: calc(var(--gap) + 6px);
      align-content:center; justify-items:center;
    }

    /* CRT-слои */
    .scanlines, .vignette, .glass, .phosphor{
      pointer-events:none; position:absolute; inset:0; border-radius:var(--crt-curve);
    }
    .scanlines{
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,var(--scan)) 0px,
        rgba(0,0,0,var(--scan)) 2px,
        transparent 3px,
        transparent 4px
      );
      mix-blend-mode:multiply;
    }
    .vignette{
      background: radial-gradient(120% 100% at 50% 50%, transparent 65%, rgba(0,0,0,.45) 100%);
    }
    .glass{
      background:
        linear-gradient(110deg, rgba(255,255,255,.06) 0 22%, transparent 22% 80%, rgba(255,255,255,.035) 80% 100%),
        radial-gradient(120% 140% at 0% 0%, rgba(255,209,220,.08), transparent 45%),
        radial-gradient(120% 140% at 100% 0%, rgba(255,227,198,.09), transparent 40%);
      filter: blur(.3px);
    }
    .phosphor{
      background:
        radial-gradient(100% 72% at 50% 44%, rgba(255,236,198,.05), transparent 52%),
        radial-gradient(80% 60% at 50% 48%, rgba(201,244,228,.04), transparent 55%);
      mix-blend-mode:screen;
    }

    /* 8-битная «рамка» экрана по периметру (внутри стекла) */
    .screen::before{
      content:""; position:absolute; inset:10px; border-radius:10px;
      background:
        linear-gradient(90deg, #0000 12px, #fff2 12px 14px, #0000 14px) 0 0/100% 8px,
        linear-gradient(180deg, #0000 12px, #fff2 12px 14px, #0000 14px) 0 0/8px 100%;
      pointer-events:none;
    }

    /* плитки-значки — яркие 8-битные карточки */
    .tile{
      --size: clamp(100px, 14.8vmin, var(--tile)); /* ещё крупнее, меньше пустоты */
      width: calc(var(--size) * 1.6);
      height: calc(var(--size) * 1.6);
      border-radius:12px;
      background: linear-gradient(180deg,#171b22,#11161c);
      border:2px solid #12161d;
      box-shadow:
        inset 0 0 0 2px #11161e,
        0 12px 26px rgba(0,0,0,.42),
        0 0 0 4px #0000;
      display:grid; grid-template-rows: 1fr auto; place-items:center;
      gap:12px;
      cursor:pointer; outline:none;
      transition:transform .08s ease, filter .08s ease, box-shadow .08s ease;
    }
    .tile:hover{ filter:brightness(1.08); }
    .tile:active{ transform:translateY(1px) scale(.996); }
    .tile[data-focus="true"]{
      box-shadow:
        inset 0 0 0 2px #1b2130,
        0 0 0 3px rgba(255,232,204,.42),
        0 18px 34px rgba(0,0,0,.55),
        0 0 18px currentColor; /* свечение в цвет карточки */
      border-color:#252c3f;
    }
    .tile canvas{
      width: calc(var(--size));
      height: calc(var(--size));
      image-rendering: pixelated;
      background:#0c1118;
      border-radius:8px;
      border:2px solid #121822;
      box-shadow: inset 0 0 0 2px #0a0f16, 0 0 0 1px rgba(0,0,0,.22);
    }
    .tile span{
      font-size:11px; color:#fff;
      text-shadow:0 1px 0 rgba(0,0,0,.6);
      letter-spacing:.8px; user-select:none; margin-bottom:6px;
    }
    /* цветовые темы карточек — как на ранних приставках: первичные яркие */
    .tile--blue{ color: var(--tile-blue); background:linear-gradient(#18233a,#11192b); }
    .tile--red{  color: var(--tile-red);  background:linear-gradient(#2a1414,#1b0c0c); }
    .tile--green{color: var(--tile-green);background:linear-gradient(#11281e,#0c1b14); }
    .tile--gold{ color: var(--tile-yellow);background:linear-gradient(#32240c,#241a08); }

    /* HUD-подсказка */
    .hud{
      position:absolute; left:0; right:0; top:10px;
      display:grid; place-items:center; pointer-events:none;
      font-size:11px; color:var(--gold);
      text-shadow:0 1px 0 rgba(0,0,0,.7), 0 0 10px rgba(255,236,188,.22);
      opacity:0; transform: translateY(-6px);
      transition:opacity .18s ease, transform .18s ease;
    }
    .hud.show{ opacity:1; transform: translateY(0); }

    /* подсказка снизу */
    .hint{
      position:absolute; bottom:12px; left:0; right:0;
      text-align:center; font-size:10px; color:#6e5a45;
      opacity:.75; text-shadow:0 1px 0 rgba(0,0,0,.7);
      pointer-events:none;
    }

    /* адаптив — сохраняем 2×2, уменьшаем внутренние отступы */
    @media (max-width: 560px){
      :root{ --gap:16px; }
      .shell{ padding:8px; }
      .bezel{ padding:6px; }
      .screen{ padding:16px; }
      .tile{ border-radius:14px; }
    }
  </style>
</head>
<body>
  <div class="cabinet" role="application" aria-label="Ретро-аркадный автомат (яркий 8-бит)">
    <div class="shell">
      <div class="bezel">
        <div class="marquee8"><span>★ 8-BIT ARCADE ★</span></div>
        <div class="screen" role="grid" aria-label="Меню">
          <button class="tile tile--blue" role="gridcell" data-idx="0" aria-label="Космос">
            <canvas width="120" height="120"></canvas>
            <span>SPACE</span>
          </button>
          <button class="tile tile--red" role="gridcell" data-idx="1" aria-label="Сердце">
            <canvas width="120" height="120"></canvas>
            <span>HEART</span>
          </button>
          <button class="tile tile--gold" role="gridcell" data-idx="2" aria-label="Ключ">
            <canvas width="120" height="120"></canvas>
            <span>KEY</span>
          </button>
          <button class="tile tile--green" role="gridcell" data-idx="3" aria-label="Бомба">
            <canvas width="120" height="120"></canvas>
            <span>BOMB</span>
          </button>

          <div class="scanlines" aria-hidden="true"></div>
          <div class="vignette" aria-hidden="true"></div>
          <div class="glass" aria-hidden="true"></div>
          <div class="phosphor" aria-hidden="true"></div>
          <div class="hud" id="hud">СТРЕЛКИ • ENTER • МЫШЬ</div>
        </div>
      </div>
      <div class="hint">↑↓←→ — перемещение • Enter — выбрать • Esc — снять выделение</div>
    </div>
  </div>

  <script>
    (function(){
      'use strict';
      const $ = (s,p=document)=>p.querySelector(s);
      const $$ = (s,p=document)=>Array.from(p.querySelectorAll(s));
      const hud = $('#hud');

      /* ---------- WebAudio (разрешается по жесту) ---------- */
      let actx, gain, unlocked=false;
      function ensureAudio(){
        if (actx) return;
        actx = new (window.AudioContext||window.webkitAudioContext)();
        gain = actx.createGain(); gain.gain.value = .16;
        gain.connect(actx.destination);
      }
      function unlock(){
        if (unlocked) return;
        ensureAudio();
        const buff = actx.createBuffer(1,1,22050);
        const src = actx.createBufferSource(); src.buffer = buff; src.connect(gain); src.start(0);
        unlocked = true;
      }

      function beep(freq=440,dur=.08){
        ensureAudio();
        const o = actx.createOscillator(); o.type='square'; o.frequency.value=freq;
        const g = actx.createGain(); g.gain.value=0.06;
        o.connect(g); g.connect(gain);
        o.start(); o.stop(actx.currentTime+dur);
      }

      addEventListener('pointerdown', unlock, {once:true});
      addEventListener('keydown', unlock, {once:true});

      /* ---------- Пиксель-рисовалки (8-бит) ---------- */
      function px(ctx,x,y,s=2,c='#fff'){ ctx.fillStyle=c; ctx.fillRect(x*s,y*s,s,s); }
      function clear(ctx){ ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height); }

      const C = {
        star:'#ffffff',
        star2:'#ffe8cc',
        ship:'#8fe4c0',   // mint
        spark:'#ffd88a',  // honey
        heart:'#ff9eb8',  // pink
        heartHi:'#ffe4ef',
        ring:'#f7c977',   // gold mid (для ключа)
        ringDark:'#d9a95b',
        ringHi:'#fff1db',
        stem:'#eecb84',
        bomb:'#3b3339',   // тёплый тёмный
        fuse:'#e6d3ff',
        flame1:'#ffd88a',
        flame2:'#ffeedd',
        haze:'#ffe0b8'    // тёплый «ореол», без синих тонов
      };

      function drawSpace(ctx){
        clear(ctx);
        const S=2, W=ctx.canvas.width/S, H=ctx.canvas.height/S;
        // фон-звёзды (тёплые)
        for(let i=0;i<84;i++){
          const x=(Math.random()*W)|0, y=(Math.random()*H)|0;
          px(ctx,x,y,S, (i%7===0)?C.star2:C.star);
        }
        // тёплый «ореол» внизу
        for(let x=0;x<W;x+=2){ px(ctx,x,H-2,S,C.haze); }
        // кораблик
        const cx=(W/2)|0, cy=(H/2)|0;
        const ship=[
          "0010000",
          "0111000",
          "1111100",
          "1111110",
          "0111111",
          "0111111",
          "1111111",
          "0100010",
          "0011100"
        ];
        for(let y=0;y<ship.length;y++){
          for(let x=0;x<ship[0].length;x++){
            if(ship[y][x]==='1') px(ctx, cx-3+x, cy-5+y, S, C.ship);
          }
        }
        // выхлоп
        px(ctx,cx-1,cy+5,S,C.spark); px(ctx,cx,cy+6,S,C.flame2);
      }

      function drawHeart(ctx){
        clear(ctx);
        const S=2, cx=24, cy=26;
        const data=[
          "00110110",
          "01111111",
          "11111111",
          "11111111",
          "11111111",
          "01111111",
          "00111111",
          "00011111",
          "00001111",
          "00000111"
        ];
        for(let y=0;y<data.length;y++){
          for(let x=0;x<data[0].length;x++){
            if(data[y][x]==='1') px(ctx, cx-4+x, cy-7+y, S, C.heart);
          }
        }
        // блик
        px(ctx,cx-1,cy-4,S,C.heartHi); px(ctx,cx,cy-5,S,C.heartHi);
      }

      /* Новый ключ в «том же ретро-стиле», плотный силуэт + тёплые блики */
      function drawKey(ctx){
        clear(ctx);
        const S=2, cx=22, cy=24;
        const key = [
          "0001111000",
          "0011111100",
          "0111111110",
          "0111011110",
          "0111011110",
          "0111111110",
          "0011111100",
          "0001111000",
          "0000110000",
          "1111111111",
          "1111111111",
          "1111000000",
          "1111100000",
          "1111000000"
        ];
        for(let y=0;y<key.length;y++){
          for(let x=0;x<key[0].length;x++){
            if(key[y][x]==='1') px(ctx, cx-6+x, cy-8+y, S, C.ring);
          }
        }
        // затемнение снизу
        for(let y=8;y<key.length;y++){
          for(let x=0;x<key[0].length;x++){
            if(key[y][x]==='1') px(ctx, cx-6+x, cy-8+y, S, C.ringDark);
          }
        }
        // блик на кольце
        px(ctx, cx-2, cy-5, S, C.ringHi);
        px(ctx, cx-1, cy-6, S, C.ringHi);
        // «зубцы»
        px(ctx, cx+7, cy+5, S, C.ringDark);
        px(ctx, cx+9, cy+6, S, C.ringDark);
      }

      function drawBomb(ctx){
        clear(ctx);
        const S=2, cx=24, cy=26;
        // корпус
        for(let y=-6;y<=6;y++){
          for(let x=-6;x<=6;x++){
            if(x*x + y*y <= 36) px(ctx,cx+x,cy+y,S,C.bomb);
          }
        }
        // фитиль
        for(let i=0;i<6;i++) px(ctx,cx+5+i,cy-10+i,S,C.fuse);
        // искра
        px(ctx,cx+12,cy-4,S,C.flame1);
        px(ctx,cx+13,cy-3,S,C.flame2);
        px(ctx,cx+12,cy-2,S,C.flame1);
      }

      const drawers=[drawSpace, drawHeart, drawKey, drawBomb];

      // инициализация 4 значков
      $$('.tile').forEach((tile, i)=>{
        const cv = tile.querySelector('canvas');
        const ctx = cv.getContext('2d',{alpha:false});
        ctx.imageSmoothingEnabled = false;
        drawers[i%drawers.length](ctx);
      });

      /* ---------- Фокус/навигация ---------- */
      let idx=0, cols=2, total=$$('.tile').length;
      function setFocus(i, withScroll=true){
        idx = Math.max(0, Math.min(total-1, i));
        $$('.tile').forEach((t, j)=> t.dataset.focus = (j===idx));
        $$('.tile')[idx].focus({preventScroll:!withScroll});
      }
      setFocus(0,false);

      function move(dir){
        const row = Math.floor(idx/cols), col = idx%cols;
        let r=row, c=col;
        if(dir==='up') r=Math.max(0,row-1);
        if(dir==='down') r=Math.min(Math.ceil(total/cols)-1,row+1);
        if(dir==='left') c=Math.max(0,col-1);
        if(dir==='right') c=Math.min(cols-1,col+1);
        setFocus(r*cols + c);
        beep(580,.035);
      }

      addEventListener('keydown', (e)=>{
        if(e.key==='ArrowUp'){ e.preventDefault(); move('up'); }
        else if(e.key==='ArrowDown'){ e.preventDefault(); move('down'); }
        else if(e.key==='ArrowLeft'){ e.preventDefault(); move('left'); }
        else if(e.key==='ArrowRight'){ e.preventDefault(); move('right'); }
        else if(e.key==='Enter'){ selectCurrent(); }
        else if(e.key==='Escape'){
          $$('.tile').forEach(t=> t.dataset.focus='false');
          hudOff();
        }
      });

      $$('.tile').forEach((t, i)=>{
        t.addEventListener('pointerenter', ()=>{ setFocus(i); });
        t.addEventListener('click', selectCurrent);
      });

      function hudOn(text){ hud.textContent=text; hud.classList.add('show'); }
      function hudOff(){ hud.classList.remove('show'); }
      function selectCurrent(){
        const tile = $$('.tile')[idx];
        const label = tile?.querySelector('span')?.textContent || 'ITEM';
        hudOn('SELECT: '+label);
        beep(480,.07);
        setTimeout(hudOff, 800);
      }

      // стартовая подсказка
      setTimeout(()=>hud.classList.add('show'), 220);
      setTimeout(hudOff, 1900);

      // DPI-фикс для чёткого пикселя
      function fixDPR(){
        const dpr = Math.max(1, window.devicePixelRatio||1);
        $$('.tile canvas').forEach(cv=>{
          const cssW = Math.max(1, parseInt(getComputedStyle(cv).width,10));
          const cssH = Math.max(1, parseInt(getComputedStyle(cv).height,10));
          if(cv.width !== cssW*dpr || cv.height !== cssH*dpr){
            cv.width = cssW*dpr; cv.height = cssH*dpr;
            const ctx=cv.getContext('2d'); ctx.imageSmoothingEnabled=false; ctx.setTransform(dpr,0,0,dpr,0,0);
          }
        });
        // перерисовать
        $$('.tile').forEach((tile, i)=>{
          const ctx = tile.querySelector('canvas').getContext('2d');
          drawers[i%drawers.length](ctx);
        });
      }
      addEventListener('resize', fixDPR, {passive:true});
      // чуть позже, чтобы успели примениться CSS-размеры
      requestAnimationFrame(fixDPR);
      setTimeout(fixDPR, 60);
    })();
  </script>
</body>
</html>
